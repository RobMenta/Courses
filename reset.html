<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Reset cache</title>
</head>
<body style="margin:0;background:#0b0f14;color:#eaf1ff;font-family:system-ui;display:flex;min-height:100vh;align-items:center;justify-content:center;padding:20px;">
  <div style="max-width:560px;width:100%;border:1px solid rgba(255,255,255,.12);border-radius:16px;padding:16px;background:rgba(255,255,255,.06);line-height:1.45;">
    <div style="font-weight:900;font-size:18px;margin-bottom:8px;">Reset en cours…</div>
    <div style="opacity:.85;">Suppression Service Worker + caches, puis retour à l’app.</div>
    <div id="status" style="opacity:.7;margin-top:10px;font-size:12px;">…</div>
  </div>

<script>
(async () => {
  const s = (t) => document.getElementById("status").textContent = t;

  try {
    s("Unregister SW…");
    if ("serviceWorker" in navigator) {
      const regs = await navigator.serviceWorker.getRegistrations();
      await Promise.all(regs.map(r => r.unregister()));
    }

    s("Delete caches…");
    if ("caches" in window) {
      const keys = await caches.keys();
      await Promise.all(keys.map(k => caches.delete(k)));
    }

    s("OK. Redirection…");
    location.replace("./");
  } catch (e) {
    s("Erreur: " + String(e));
  }
})();
</script>
</body>
</html>
